<form *ngIf="projectSelectedMaterials" [formGroup]="materialForms">
    <div class="row ">
        <div class="col-xs-10 text-right p-t-10 border-input">
            <mat-form-field class="input-search-padding-zero pull-right">
                <input matInput placeholder="Search Projects" type="search" [(ngModel)]="searchText"
                    [ngModelOptions]="{standalone: true}" />
                <button mat-button matSuffix mat-icon-button>
                    <mat-icon>search</mat-icon>
                </button>
            </mat-form-field>
        </div>
        <div class="col-xs-2 text-right p-b-10">
            <span>
                <button mat-raised-button [disabled]="!materialForms.valid" matStepperNext (click)="materialAdded()"
                    class="main-background-color main-button color-white">
                    Next
                </button>
            </span>
        </div>
    </div>
    <div *ngFor="let material of projectSelectedMaterials| SearchPipe: searchText:'projectName';let mati=index">
        <mat-accordion class="accordion-padding-zero" formArrayName="forms">
            <mat-expansion-panel [expanded]="true">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        {{material.projectName }}
                        <a href="javascript:void(0)" (click)="openDialog(material)"
                            class="main-color p-l-15">{{material.defaultAddress.addressLine1}}</a>
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <table mat-table [dataSource]="material.projectMaterialList" class="mat-elevation-z8 col-sm-12">
                    <ng-container matColumnDef="Material Name">
                        <th mat-header-cell *matHeaderCellDef>Material Name</th>
                        <td mat-cell *matCellDef="let element">
                            {{ element.materialName }}
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="Required Date">
                        <th mat-header-cell *matHeaderCellDef>Required Date</th>
                        <td mat-cell *matCellDef="let element; let i = index">
                            {{ element.dueDate }}
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="Requested Quantity">
                        <th mat-header-cell *matHeaderCellDef>Requested Quantity</th>
                        <td mat-cell *matCellDef="let element">{{ element.requestedQty }}</td>
                    </ng-container>
                    <ng-container matColumnDef="Estimated Quantity">
                        <th mat-header-cell *matHeaderCellDef>Estimated Quantity</th>
                        <td mat-cell *matCellDef="let element">{{ element.estimatedQty }}</td>
                    </ng-container>
                    <ng-container matColumnDef="Estimated Rate">
                        <th mat-header-cell *matHeaderCellDef>Estimated Rate</th>
                        <td mat-cell *matCellDef="let element; let i = index">
                            <mat-form-field
                                [formGroupName]="(i +  (mati ? projectSelectedMaterials[mati].prevMatListLength : 0))"
                                class="border-input table-input">
                                <input matInput formControlName="estimatedRate" type="number"
                                    placeholder="Estimated Rate" />
                            </mat-form-field>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="Quantity">
                        <th mat-header-cell *matHeaderCellDef>Quantity</th>
                        <td mat-cell *matCellDef="let element; let  i= index">
                            <mat-form-field
                                [formGroupName]="(i +  (mati ? projectSelectedMaterials[mati].prevMatListLength : 0))"
                                class="border-input table-input">
                                <input matInput formControlName="quantity" type="number" placeholder="Quantity" />
                            </mat-form-field>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="Makes">
                        <th mat-header-cell *matHeaderCellDef>Makes</th>
                        <td mat-cell *matCellDef="let element; let  i= index">
                            <app-chip
                                (onUpdate)="makesUpdate($event, (i +  (mati ? projectSelectedMaterials[mati].prevMatListLength : 0)))">
                            </app-chip>

                        </td>
                    </ng-container>


                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                </table>
            </mat-expansion-panel>
        </mat-accordion>
    </div>
</form>