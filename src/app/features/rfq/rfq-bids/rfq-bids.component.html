<div class="page-start-point">
  <div class="p-l-20 p-r-20 p-b-20 min-height parent">
    <div class="row p-t-10 p-b-10">
      <div class="col-sm-12">
        <span>
          <button mat-raised-button class="main-background-color main-button color-white pull-right"
            (click)="allocateQuantity()">
            Allocate Quantity
          </button>
        </span>
      </div>
    </div>
    <form *ngIf="rfqProjects.length" (ngSubmit)="allocateQuantity()" [formGroup]="rfqForms">
      <div formArrayName="forms">
        <div class="customBid">
          <div *ngFor="let project of rfqProjects; let p = index" [formGroupName]="p">
            <mat-accordion displayMode="flat" multi class="mat-table">
              <mat-expansion-panel class="mat-expansion-panel-body">
                <mat-expansion-panel-header class="row">
                  <section matSort class="mat-elevation-z2">
                    <span mat-sort-header="vesselName">{{ project.projectName }}<span
                        class="p-l-5">{{ project.addressLine1 }}</span></span>
                  </section>
                </mat-expansion-panel-header>
                <div>
                  <section class="mat-elevation-z2 mat-header-row">
                    <span class="col-xs-2">Material Name</span>
                    <span class="col-xs-2">Quantity</span>
                    <span class="col-xs-8">Makes & Rates</span>
                  </section>
                </div>
                <ng-container formArrayName="materialList">
                  <mat-expansion-panel class="p-0" *ngFor="let material of project.materialList; let m = index"
                    [formGroupName]="m">
                    <mat-expansion-panel-header class="mat-row">
                      <span class="col-xs-2">{{ material.materialName }} </span>
                      <span class="col-xs-2"> {{ material.rfqMaterialQty }} </span>
                      <span class="col-xs-1" *ngFor="let brand of material.brandNames">
                        {{ brand }}
                      </span>
                    </mat-expansion-panel-header>

                    <span formArrayName="supplierList">
                      <div class="mat-row" *ngFor="
                          let supplier of material.supplierList;
                          let s = index
                        " [formGroupName]="s">
                        <span class="col-xs-2 ">{{ supplier.supplierName }}
                        </span>
                        <span class="col-xs-2"></span>
                        <span formArrayName="brandGroup">
                          <span class="col-xs-1 p-l-0" *ngFor="
                              let brandInfo of supplier.brandDetailList;
                              let i = index
                            " [formGroupName]="i">
                            <span *ngIf="brandInfo != null">
                              <mat-form-field class="border-input">
                                <input class="quantity p-l-0 m-r-5" matInput formControlName="quantity"
                                  placeholder="quantity" />
                              </mat-form-field>
                              <span *ngIf="brandInfo.materialUnitPrice != null">{{ brandInfo.materialUnitPrice }}</span>
                            </span>
                          </span>
                        </span>
                      </div>
                    </span>
                  </mat-expansion-panel>
                </ng-container>
              </mat-expansion-panel>
            </mat-accordion>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>